{% extends "base.html" %}

{% block title %}Dashboard - BudgetBro{% endblock %}

{% block content %}
<div class="dashboard-wrapper">

    <h2 class="welcome-title">Willkommen zurÃ¼ck!</h2>
    <p class="welcome-sub">Du schlÃ¤gst dich super - immer weitersparen ğŸ’ª</p>

    <div class="dashboard-grid">

        <div class="card sankey-card">
            <h3>ğŸ’¸ FinanzÃ¼bersicht</h3>
            <div class="sankey-actions">
                <a class="btn-link" href="{{ url_for('sankey_full') }}" target="_blank" rel="noopener">Fullscreen
                    Ã¶ffnen</a>
            </div>
            <div class="sankey-wrapper">
                {{ graph_html|safe }}
            </div>
        </div>

        <div class="goal-card">
            <h3>ğŸ¯ Sparziel{% if goal and goal.title %}: {{ goal.title }}{% endif %}</h3>
            {% if goal %}
            {% set pct = 0 %}
            {% if goal.target_amount and goal.target_amount > 0 %}
            {% set pct = (goal.saved_amount / goal.target_amount * 100) %}
            {% endif %}
            <p class="goal-amount">{{ goal.saved_amount|round(2) }}â‚¬ <span>/ {{ goal.target_amount|round(2) }}â‚¬</span>
            </p>
            <div class="goal-progressbar">
                <div class="goal-progress" style="width: {{ [pct, 100]|min }}%;"></div>
            </div>
            <p class="goal-percent">{{ [pct, 100]|min|round(0) }}% erreicht</p>
            {% else %}
            <p class="goal-amount">Kein Ziel gesetzt</p>
            <div class="goal-progressbar">
                <div class="goal-progress" style="width: 0%;"></div>
            </div>
            <p class="goal-percent">0% erreicht</p>
            {% endif %}
        </div>

        <div class="card">
            <h3>ğŸ“Š Budget Gesundheit</h3>
            <p>Erfahre mehr Ã¼ber deine finanzielle Gesundheit</p>
            <a class="btn-link" href="{{ url_for('budget_health') }}">Zur Analyse</a>
        </div>

    </div>
</div>
{% endblock %}